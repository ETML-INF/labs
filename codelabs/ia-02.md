author: Helder Costa
summary: ia tuto
id: ia-02
categories: ia,python,dev
tags: ict
environments: Web
status: Published
feedback link: https://git.section-inf.ch/jmy/labs/issues
analytics account: UA-170792591-1

# L'analyse d'images

## Vue d‚Äôensemble
Duration: 0:05:00

Nous arrivons √† la fin de notre tour d'horizon de l'intelligence artificielle en nous concentrant maintenant sur la reconnaissance d'images. Bien que les syst√®mes de reconnaissance d'images soient g√©n√©ralement performants, ils pr√©sentent certaines limites.

Les images contiennent souvent une grande quantit√© d'informations. Il est donc essentiel, dans un premier temps, de d√©terminer la pertinence de chaque objet dans l'image. Il est √©galement crucial de comprendre comment le syst√®me identifie le d√©but et la fin de chaque objet. Cela aide √† appr√©hender les d√©fis que le syst√®me doit surmonter pour fournir des r√©sultats pr√©cis.

De plus, comme le syst√®me ne peut pas toujours donner une r√©ponse d√©finitive, il propose g√©n√©ralement trois r√©ponses possibles avec une probabilit√© associ√©e √† chacune. Cette probabilit√© varie de 0 √† 1, o√π 1 indique une certitude de 100 %.

Survey
: Quelle est votre premi√®re r√©action en entendant parler de la reconnaissance d'images ?
<ul>
   <li><strong>C'est impressionnant, mais complexe.</strong> - Admiration pour les capacit√©s technologiques m√™l√©e √† une reconnaissance de la complexit√© du domaine.</li>
   <li><strong>√áa a un √©norme potentiel !</strong> - Enthousiasme pour les nombreuses applications possibles, de la m√©decine √† la s√©curit√©.</li>
   <li><strong>Les syst√®mes ne sont pas encore parfaits.</strong> - R√©alisme face aux d√©fis et aux limites actuelles de la reconnaissance d'images.</li>
</ul>

## Setup

### ZIP

[T√©l√©charger l‚Äôarchive suivante](https://eduvaud.sharepoint.com/:u:/s/msteams_d0db31/EXzBITLp2AdAhyhdaxd9qZMBqfqmT90Qb1OPAr-sVO2vyw?e=XNlAqN)

### Commandes
Maintenant que nous avons couvert ces aspects, tu peux proc√©der √† l'installation des d√©pendances en utilisant le fichier `requirements.txt`. Charge ce fichier comme d'habitude avec la commande suivante :

```bash
python -m pip install -r requirements.txt
```

Notre programme utilise les biblioth√®ques TensorFlow et Pillow. Voici comment installer ces biblioth√®ques :

```bash
python -m pip install tensorflow pillow
```

Je vais te donner un aper√ßu rapide du code, et je t'expliquerai plus en d√©tail le r√¥le de chaque bloc plus tard. L'objectif est que tu comprennes comment le programme fonctionne sans entrer dans les moindres d√©tails.

```python
import tensorflow as tf
from tensorflow.keras.preprocessing import image
from tensorflow.keras.applications.resnet50 import ResNet50, preprocess_input, decode_predictions
import numpy as np

# Charger le mod√®le pr√©-entra√Æn√© ResNet50
model = ResNet50(weights='imagenet')

def classify_image(image_path):
    # Charger l'image et la redimensionner
    img = image.load_img(image_path, target_size=(224, 224))
    
    # Convertir l'image en tableau numpy
    img_array = image.img_to_array(img)
    
    # Ajouter une dimension suppl√©mentaire pour le batch
    img_array = np.expand_dims(img_array, axis=0)
    
    # Pr√©traiter l'image pour le mod√®le
    img_array = preprocess_input(img_array)
    
    # Pr√©dire la classe de l'image
    predictions = model.predict(img_array)
    
    # D√©coder les pr√©dictions pour obtenir les labels
    decoded_predictions = decode_predictions(predictions, top=3)[0]
    
    # Afficher les r√©sultats
    for i, (imagenet_id, label, score) in enumerate(decoded_predictions):
        print(f"{i + 1}: {label} ({score:.2f})")

# Exemple d'utilisation
image_path = 'chemin/vers/votre/image.jpg'
classify_image(image_path)
```

### Explication du code
Duration: 0:01:00

- **Importation des biblioth√®ques** : Les biblioth√®ques TensorFlow et Pillow sont import√©es pour charger et traiter les images, ainsi que pour utiliser le mod√®le pr√©-entra√Æn√© ResNet50.
- **Chargement du mod√®le** : Nous chargeons le mod√®le ResNet50, qui a √©t√© pr√©-entra√Æn√© sur le dataset ImageNet. Cela signifie que le mod√®le a d√©j√† appris √† reconna√Ætre un grand nombre d'objets et de caract√©ristiques √† partir de millions d'images. En utilisant ce mod√®le pr√©-entra√Æn√©, nous pouvons tirer parti de cette connaissance pr√©alable pour effectuer des pr√©dictions sur de nouvelles images, sans avoir √† entra√Æner le mod√®le depuis le d√©but.
- **Fonction `classify_image`** : Cette fonction charge une image, la redimensionne, la pr√©pare pour le mod√®le, effectue une pr√©diction et affiche les trois principales pr√©dictions avec leurs scores de confiance.

## üìù Exercice
Duration: 0:15:00

Maintenant, tu peux ajouter des images dans le dossier en les nommant `monImageXX.jpg`. üìÅüì∏
Apr√®s avoir ajout√© tes images, teste si elles sont correctement reconnues par le mod√®le. ü§ñüîç
Attention : Les noms des objets (animaux ou autres) seront en anglais, sauf si le dictionnaire de traduction contient la traduction. üåçüî†

## Conclusion
Duration: 0:02:00

Le mod√®le de reconnaissance d'images a r√©ussi √† identifier et traduire les noms d'animaux ü¶Å et d'objets üöó pour la plupart des images fournies. Bien que certaines traductions aient n√©cessit√© des ajustements manuels, le programme a montr√© une solide capacit√© √† classifier divers animaux et objets gr√¢ce au mod√®le pr√©-entra√Æn√© ResNet50.

Le mod√®le fonctionne de mani√®re efficace pour les images de haute qualit√© et pour les cat√©gories bien repr√©sent√©es dans le jeu de donn√©es ImageNet. Cependant, pour des animaux plus rares ou des objets sp√©cifiques, il pourrait √™tre b√©n√©fique d'am√©liorer le mod√®le ou d'utiliser un jeu de donn√©es plus sp√©cialis√©.

L'ajout d'un dictionnaire de traduction a rendu les r√©sultats plus accessibles pour les utilisateurs francophones. Cette approche pourrait encore √™tre perfectionn√©e en √©largissant le dictionnaire pour inclure davantage de termes.

Nous te remercions pour ta participation et te souhaitons une excellente fin de journ√©e.

## Synth√®se
Duration: 0:03:00

todo :‚ÄØ5‚ÄØpourquoi du comportement